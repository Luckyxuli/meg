2012年和2013年高血压患者的年龄差异
select ?eca1 ?eca2
where {
    ?e1 sem:hasActor ?p1;
        sem:hasObject ?disease ;
        peg-o:condition_age ?eca1 ;
        sem:hasTimeStamp ?et1.
  filter(?et1 > "2012-01-01"^^xsd:date || ?et1 < "2012-12-31"^^xsd:date )
    ?e2 sem:hasActor ?p2 ;
        sem:hasObject ?disease ;
        peg-o:condition_age ?eca2 ;
         sem:hasTimeStamp ?et2.
  filter(?et2 > "2013-01-01"^^xsd:date || ?et2 < "2013-12-31"^^xsd:date )
  
  ?disease rdfs:label "高血压病"
}

患有双侧膝关节炎后血脂紊乱的患者的平均年龄
select ?age
where {
  ?p peg-o:birthdate ?p_birthdate .
    ?e1 sem:hasActor ?p;
        sem:hasObject ?disease .
  ?disease rdfs:label "双侧膝关节炎" .
  
    ?e2 sem:hasActor ?p ;
        sem:hasObject ?assay ;
        peg-o:measurement_prompt "紊乱" ;
        sem:hasTimeStamp ?et2.
  ?assay rdfs:label "血脂" .
  ?e2 peg-o:after ?e1 .
  bind(year(?et2)-year(?p_birthdate) as ?age)
}

同时被诊断为咳嗽和风寒外袭的患者住了多少次院
SELECT  (count(?VISIT_EVENT)as ?ve_count)
#SELECT ?patient
WHERE{
	?e1 sem:eventType peg-o:CONDITION_EVENT .
	?e1 sem:hasActor ?patient .
	?e2 sem:eventType peg-o:CONDITION_EVENT .
	?e2 sem:hasActor ?patient .
  	?VISIT_EVENT sem:eventType peg-o:VISIT_EVENT .
  	?VISIT_EVENT sem:hasActor ?patient  .
	?e1 sem:hasObject ?disease1 .
	?e2 sem:hasObject ?disease2 .
	?disease1 rdfs:label "咳嗽" .
	?disease2 rdfs:label "风寒外袭" .
  	?e1 peg-o:concurrent ?e2 .
}
患有冠心病且患有不稳定性心绞痛的人数
SELECT  (count(?patient)as ?patient_count)
WHERE{
	?e1 sem:eventType peg-o:CONDITION_EVENT .
	?e1 sem:hasActor ?patient .
	?e2 sem:eventType peg-o:CONDITION_EVENT .
	?e2 sem:hasActor ?patient .
	?e1 sem:hasObject ?disease1 .
	?e2 sem:hasObject ?disease2 .
	?disease1 rdfs:label "冠心病" .
	?disease2 rdfs:label "不稳定性心绞痛" .
  	?e1 peg-o:concurrent ?e2 .
}

首次患有冠心病，1年内又首次被诊断为气阴两虚证的患者的红细胞压积检验结果
SELECT ?patient ?d ?t1 ?t2 ?measurement_result
WHERE{
	?e1 sem:hasActor ?patient .
  	?e1 sem:hasTimeStamp ?t1 .
  	?e1 peg-o:first_condition true .
	?e2 sem:hasActor ?patient .
  	?e2 sem:hasTimeStamp ?t2 .
  	?e2 peg-o:first_condition true .
	?e3 sem:hasActor ?patient .
	?e1 sem:hasObject ?disease1 .
	?e2 sem:hasObject ?disease2 .
  	?e3 sem:hasObject ?assay .
  	?e3 peg-o:measurement_result ?measurement_result .
  	?e3 sem:hasTimeStamp ?t3 .
	?disease1 rdfs:label "冠心病" .
  	?assay rdfs:label "红细胞压积" .
	?disease2 rdfs:label "气阴两虚证" .
	filter(((year(?t2)-year(?t1))*12+(month(?t2)-month(?t1))<12) && ((year(?t2)-year(?t1))*12+(month(?t2)-month(?t1))>0))

}

患有2型糖尿病和慢性心衰的患者的血小板分布宽度的结果
SELECT ?patient ?measurement_result
WHERE{
	?e1 sem:eventType peg-o:CONDITION_EVENT .
	?e1 sem:hasActor ?patient .
	?e2 sem:eventType peg-o:CONDITION_EVENT .
	?e2 sem:hasActor ?patient .
	?e1 sem:hasObject ?disease1 .
	?e2 sem:hasObject ?disease2 .
	?disease1 rdfs:label "2型糖尿病" .	
	?disease2 rdfs:label "慢性心衰" .
  	?e3 sem:eventType peg-o:MEASUREMENT_EVENT .
	?e3 sem:hasActor ?patient .
  	?e3 sem:hasObject ?assay .
  	?e3 peg-o:measurement_result ?measurement_result .
  	?assay rdfs:label "血小板分布宽度" .

}

在服用格华止片的六个月内，2型糖尿病患者的糖类抗原125变化趋势
SELECT ?patient  ?measurement_result
WHERE{
	?e1 sem:hasActor ?patient .
  	?e1 sem:hasTimeStamp ?t1 .
	?e2 sem:hasActor ?patient .
  	?e2 sem:hasTimeStamp ?t2 .
	?e1 sem:hasObject ?drug .
	?e2 sem:hasObject ?disease1 .
	?disease1 rdfs:label "2型糖尿病" .
  	?drug rdfs:label "格华止片" .
	filter(((year(?t2)-year(?t1))*12+(month(?t2)-month(?t1))<6) && ((year(?t2)-year(?t1))*12+(month(?t2)-month(?t1))>0))
	?e3 sem:hasActor ?patient .
  	?e3 sem:hasObject ?assay .
  	?e3 peg-o:measurement_result ?measurement_result .
  	?e3 sem:hasTimeStamp ?t3  .
  	?assay rdfs:label "糖类抗原125" .
}


肝肾不足证的患者服用哪些ACEI类药期间血红蛋白水平正常
SELECT ?drugname
WHERE{
	?e1 sem:hasActor ?patient .
	?e1 sem:hasObject ?disease1 .
  	?disease1 rdfs:label "肝肾不足证" .
  	?e2 sem:hasActor ?patient .
	?e2 sem:hasObject ?drug .
  	?e2 sem:hasBeginTimeStamp ?t1 .
 	?e2 sem:hasEndTimeStamp ?t2 .
  	?drug rdfs:label ?drugname .
        ?drug peg-o:isHyponymOf dsc:ACEI类药 .
	?e3 sem:hasActor ?patient .
  	?e3 sem:hasObject ?assay .
  	?e3 sem:hasTimeStamp ?t3 .
   	?assay rdfs:label "血红蛋白" .
  	?e3 peg-o:measurement_prompt "正常" .
  	 ?e3 peg-o:during ?e2 .
}

被诊断为肥厚性梗阻性心肌病经过药物治疗并且好转的患者
SELECT ?patient ?t2
WHERE{
  	?e1 sem:eventType peg-o:TREATMENT_EVENT .
	?e1 sem:hasActor ?patient .
 	?patient peg-o:person_id 6 .
	?e2 sem:hasActor ?patient .
  	?e2 sem:hasTimeStamp ?t2 .
	?e2 sem:hasObject ?disease1 .
	?disease1 rdfs:label "肥厚性梗阻性心肌病" .
  	?e2 peg-o:situation "好转" .
}


进行过心脏临时性起博器植入术之后，心衰病患者慢性心力衰竭急性加重的人次
SELECT (count(?patient)as ?patient_count)
WHERE{
	?e1 sem:hasActor ?patient .
  	?e1 sem:hasTimeStamp ?t1 .
	?e2 sem:hasActor ?patient .
  	?e2 sem:hasTimeStamp ?t2 .
	?e1 sem:hasObject ?disease1 .
	?e2 sem:hasObject ?disease2 .
	?disease1 rdfs:label "心衰病" .
    	?disease2 rdfs:label "慢性心力衰竭急性加重" .
 	filter(((year(?t1)-year(?t3))*12+(month(?t1)-month(?t3))>0)&&((year(?t2)-year(?t1))*12+(month(?t2)-month(?t1))>0))
	?e3 sem:hasActor ?patient .
  	?e3 sem:hasObject ?procedure .
  	?procedure rdfs:label "心脏临时性起博器植入术".
  	?e3 sem:hasTimeStamp ?t3  .
}
